{% extends 'base.html' %}
{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.serializeJSON/1.2.0/jquery.serializeJSON.min.js"></script>
<script src="../static/brews.js">
</script>
<h2>{{ recipe }}</h2>
<table>
	<form action="/brew/{{ brew.id }}" method="post">
		<tr>
			<td>
				Brew Date: <input type="date" name="brew_date" id="brew_date" class="form-control" style="width: 200px" value={{ brew.date }}>

				<h2>1. Steep</h2>
					<div id="steep-instructions">
						<p>Bring {{ batch_size }} {{ batch_units }} to a 165 degrees. </p>
						<p>Prepare the following grains for steeping:
							<ul>
							{% for grain in steep %}
								<li>{{ grain.name }} - {{ grain.amount }} {{ grain.units }}</li>
							{% endfor %}
							</ul>
							</p>
						<p>Steep for <span class="timer" id="steep">30 minutes</span>.</p> 
					</div>
				<h2>2. Boil</h2> 
					<div id="boil-instructions">
						<p>Bring water to a boil. Turn off flame and add sugars:</p>
						<ul>
						{% for extract in extracts %}
							<li>{{ extract.name }} - {{ extract.amount }} {{ extract.units }} </li>
						{% endfor %}
						</ul>
						<p>Return to boil. Start boil time: <input type="time" name-"boil_start"></p>
						{% for time in times %}
						<br>At {{ time }} minutes:
							{% for ingredient in boiltime[time] %}
							<p>{{ ingredient["amount"] }} {{ ingredient["units"] }} {{ ingredient["name"] }}</p>
							{% endfor %}
							{% if timerset[time] > 0 %}
							<button type="button" class="timer form-control" id="timer" value="{{ timerset[time] }}" style="width: 100px; display: inline;">Timer</button>

							<div id="popUpDiv" style="display:none; border: solid gray; width: 150px;">
							<input id="clock" value="{{ timerset[time] }}:00" style="width: 100px"><br>
								<button type="button" class="start" id="start">Start</button>
								<button type="button" class="stop" id="stop">Stop</button>
								<button type="button" class="clos" id="close">Close</button>
							</div>
							{% endif %}
						{% endfor %}
					</div>
				<h2>3. Cool</h2>

				<h2>4. Primary</h2> 
					<div id="transfer-instructions">
						<p>Transfer to primary. </p>

						<p>Add yeast: 
						{% for item in yeast %} 
							{{ item.name }} {{ item.amount }} {{ item.units }} 
						{% endfor %}
						</p>
						<p>Original gravity: <input type="text" step="0.01" name="orig_gravity" id="orig_gravity" class="form-control" style="width: 100px; display: inline" value="{{ brew.og }}"></p>
						<p>Original gravity range for this style: {{ og_min }} - {{ og_max }}</p>
						<div>
							<p>Current gravity measurement: <input type="float" name="curr_gravity" id="curr_gravity" class="form-control" style="width: 100px; display: inline"> Measured on: <input type="date" name="cg_date" id="cg_date">
							</p>

						</div>
						<p>
						<h3>Add a reminder</h3>
						<p>Schedule the next gravity check in <input type="number" name="c-days" id="c-days" class="form-control" style="width: 100px; display: inline"> days.
						<span class="addtocalendar atc-style-blue" id="g-days">
	        				<var class="atc_event">
				            <var class="atc_date_start" id="date_start"></var>
				            <var class="atc_date_end" id="date_end"></var>
				            <var class="atc_timezone">Pacific/Midway</var>
				            <var class="atc_title">Gravity Check</var>
				            <var class="atc_description">Check gravity for {{ recipe }}</var>
				            <var class="atc_location">At your brew</var>
					        </var>
					    </span>

						</p>
						<p>Other next step: <input type="text" name="reminder" id="reminder" class="form-control">
						Set reminder for <input type="number" name="weeks" id="r-days" class="form-control" style="width: 100px; display: inline"> days.	
						<span class="addtocalendar atc-style-blue" id="cal-reminder">
        					<var class="atc_event">
				            <var class="atc_date_start" id="r_date_start"></var>
				            <var class="atc_date_end" id="r_date_end"></var>
				            <var class="atc_timezone">Pacific/Midway</var>
				            <var class="atc_title" id="cal_title"></var>
				            <var class="atc_description" id="cal_desc"></var>
				            <var class="atc_location">At your brew</var>
				        </var>
				    	</span>
					</div>

				<h2>5. Secondary</h2>
					<div id="secondary-instructions">
					{% if secondary %}
					<p>Add:
						{% for item in secondary %}
							{{ item }}
						{% endfor %}
					{% else %}
					</p>
						<p>"There are no secondary steps for this beer."</p>
					
					{% endif %}


					</div>
					<p>
					Date finished: <input type="date" id="finished" name="finished" class="form-control" style="width: 200px; display: inline" value="{% if brew.end_date %}{{ brew.end_date }}{% endif %}">
					Final gravity: <input type="text" id="final_gravity" name="final_gravity" class="form-control" style="width: 100px; display: inline" value="{{ brew.fg }}"><span id="abv"></span><span id="abv_val"></span></p><br><br>
					


				<p><input type="submit" value="Save Brew" class="form-control"></p>
			</td>
			<td style="vertical-align: top">
				<br>
				<input type="submit" value="Save and Return Later" class="form-control">

				<h2>Recipe Notes:</h2>
				{{ notes }}<br>
				<h2>My notes:</h2>
					<input type="textbox" name="brew_notes" id="brew_notes" style="width: 300px; height: 300px" value="{{ brew.notes }}">
				<h2>Results</h2>
					<input type="textbox" name="results_notes" id="results_notes" style="width: 300px; height: 300px" value="{{ brew.results_notes }}">
				<h2>Rating:</h2>
					<div id="rating" class="rating">
					    <span><input type="radio" name="rating" id="str5" value="1" {% if brew.rating == 1 %} checked {% endif %}><label for="str1"></label></span>
					    <span><input type="radio" name="rating" id="str4" value="2" {% if brew.rating == 2 %} checked {% endif %}><label for="str2"></label></span>
					    <span><input type="radio" name="rating" id="str3" value="3" {% if brew.rating == 3 %} checked {% endif %}><label for="str3"></label></span>
					    <span><input type="radio" name="rating" id="str2" value="4"{% if brew.rating == 4 %} checked {% endif %}><label for="str4"></label></span>
					    <span><input type="radio" name="rating" id="str1" value="5" {% if brew.rating == 5 %} checked {% endif %}><label for="str5"></label></span>
					</div>
			</td>
		</tr>
	</form>
</table>
{% endblock %}